generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Session {
  id            String    @id
  shop          String    @unique
  state         String
  isOnline      Boolean   @default(false)
  scope         String?
  expires       DateTime?
  accessToken   String
  userId        BigInt?
  firstName     String?
  lastName      String?
  email         String?
  accountOwner  Boolean   @default(false)
  locale        String?
  collaborator  Boolean?  @default(false)
  emailVerified Boolean?  @default(false)
}

model shopify_sessions {
  id               String    @id
  shop             String
  state            String?
  isOnline         Boolean?
  scope            String?
  expires          DateTime?
  accessToken      String?
  userId           BigInt?
  onlineAccessInfo String?

  @@map("shopify_sessions")
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
}

model Product {
  id             Int     @id @default(autoincrement())
  name           String
  category       String
  sku            String  @unique
  productionTime Int
  orders         Order[]
}

model Order {
  id           Int      @id @default(autoincrement())
  customerName String
  quantity     Int
  orderDate    DateTime
  deliveryDate DateTime
  status       String
  userId       Int
  productId    Int
  product      Product  @relation(fields: [productId], references: [id])
}

model Capacity {
  id            Int      @id @default(autoincrement())
  date          DateTime @unique
  totalCapacity Int
  usedCapacity  Int      @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  closed        Boolean  @default(false)
}

model StoreSettings {
  id                  Int      @id @default(autoincrement())
  shop                String?
  timezone            String   @default("Europe/London")
  defaultDespatchLead Int      @default(1)
  defaultDeliveryLead Int      @default(2)
  countryOverrides    Json?
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  accessToken         String?
  despatchCutoffTime  String?
}

model Allocation {
  id           Int      @id @default(autoincrement())
  orderId      String
  capacityId   Int
  despatchDate DateTime
  createdAt    DateTime @default(now())
}
